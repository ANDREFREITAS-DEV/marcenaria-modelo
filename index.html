<!DOCTYPE html>
<html lang="pt-BR" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NEC Planejados | A Excelência da Arquitetura</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600&family=Playfair+Display:ital,wght@0,400;0,600;0,700;1,400&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
	<link rel="manifest" href="manifest.json">

    <script>
        tailwind.config = {
            theme: {
                extend: { colors: { nec: { dark: '#111111', gold: '#C5A059', gray: '#F8F8F8', charcoal: '#1F2937' } }, fontFamily: { sans: ['Inter', 'sans-serif'], serif: ['Playfair Display', 'serif'] } }
            }
        }
    </script>
    <style>
        .video-slide { position: absolute; top: 0; left: 0; width: 100%; height: 100%; object-fit: cover; opacity: 0; transition: opacity 1.5s ease-in-out; }
        .video-slide.active { opacity: 1; }
        .whatsapp-float { position: fixed; bottom: 30px; right: 30px; background-color: #25d366; color: white; width: 64px; height: 64px; border-radius: 50%; display: flex; justify-content: center; align-items: center; font-size: 32px; box-shadow: 0 4px 14px rgba(0,0,0,0.25); z-index: 9999; transition: all 0.3s ease; }
        .whatsapp-float:hover { transform: scale(1.1); }
        .timeline-item { position: relative; padding-left: 2rem; border-left: 2px solid #333; padding-bottom: 2rem; }
        .timeline-item:last-child { border-left: 2px solid transparent; }
        .timeline-dot { position: absolute; left: -9px; top: 0; width: 16px; height: 16px; border-radius: 50%; background: #333; transition: all 0.3s; }
        .timeline-item.completed .timeline-dot { background: #C5A059; box-shadow: 0 0 10px #C5A059; }
        .timeline-item.completed { border-left-color: #C5A059; }
    </style>
</head>
<body class="font-sans text-gray-800 antialiased bg-white selection:bg-nec-gold selection:text-white">

    <script>
        const PROJECT_URL = 'https://jbtqvheeeqtiovakfqcn.supabase.co'; 
        const PROJECT_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImpidHF2aGVlZXF0aW92YWtmcWNuIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjU5ODcxNzEsImV4cCI6MjA4MTU2MzE3MX0.T93A20M56NiKamag6FW6q1T2YnFiSu5s3snFGMSsIHQ'; 
        const supabaseClient = window.supabase.createClient(PROJECT_URL, PROJECT_KEY);
    </script>

    <nav id="navbar" class="fixed w-full z-50 transition-all duration-300 py-6 px-6 lg:px-12 bg-transparent text-white border-b border-white/10 hover:bg-nec-dark/95 hover:backdrop-blur-md">
        <div class="max-w-7xl mx-auto flex justify-between items-center">
            <a href="#" class="text-2xl lg:text-3xl font-serif font-bold tracking-widest text-white group">NEC<span class="text-nec-gold text-sm align-top ml-1 group-hover:text-white transition-colors">PLANEJADOS</span></a>
            <div class="hidden lg:flex gap-8 items-center text-sm font-medium tracking-wide uppercase">
                <a href="#home" class="hover:text-nec-gold transition-colors">Home</a>
                <a href="#area-cliente" class="text-nec-gold hover:text-white transition-colors font-bold"><i class="fa-solid fa-truck-fast"></i> Rastrear Pedido</a>
                <a href="#sobre" class="hover:text-nec-gold transition-colors">A Arquiteta</a>
                <a href="#projetos" class="hover:text-nec-gold transition-colors">Portfólio</a>
                <a href="#contato" class="bg-white text-nec-dark hover:bg-nec-gold hover:text-white px-6 py-2 transition-all font-bold">Orçamento</a>
            </div>
            <button class="lg:hidden text-2xl" onclick="toggleMenu()"><i class="fa-solid fa-bars"></i></button>
        </div>
        <div id="mobile-menu" class="hidden absolute top-full left-0 w-full bg-nec-dark text-white p-6 shadow-xl lg:hidden border-t border-white/10">
            <div class="flex flex-col gap-4 text-center uppercase text-sm tracking-widest">
                <a href="#home" class="py-3 border-b border-white/10">Home</a>
                <a href="#area-cliente" class="py-3 text-nec-gold font-bold border-b border-white/10">Rastrear Pedido</a>
                <a href="#contato" class="py-3">Orçamento</a>
            </div>
        </div>
    </nav>

    <section id="home" class="relative h-screen flex items-center justify-center overflow-hidden bg-black">
        
        <div class="absolute inset-0 z-0">
            <video muted loop playsinline class="video-slide active">
                <source src="video1.mp4" type="video/mp4">
            </video>
            <video muted loop playsinline class="video-slide">
                <source src="video2.mp4" type="video/mp4">
            </video>
            <video muted loop playsinline class="video-slide">
                <source src="video3.mp4" type="video/mp4">
            </video>
        </div>

        <div class="absolute inset-0 bg-gradient-to-b from-black/80 via-black/30 to-black/80 z-10"></div>
        <div class="absolute bottom-0 left-0 h-1 bg-white/20 z-20 w-full">
            <div id="progress-bar" class="h-full bg-nec-gold w-0"></div>
        </div>

        <div class="relative z-20 text-center text-white px-4 max-w-5xl mx-auto" data-aos="fade-up">
            <div class="inline-block border border-nec-gold/50 bg-black/40 backdrop-blur-md px-6 py-2 mb-8 rounded-full">
                <p class="text-nec-gold tracking-[0.2em] uppercase text-xs font-bold">
                    <i class="fa-solid fa-location-dot mr-2"></i>Parque Industrial 2 • Andradina
                </p>
            </div>
            
            <h1 class="font-serif text-5xl lg:text-7xl mb-8 leading-tight drop-shadow-2xl">
                A Excelência da Arquitetura. <br>
                <span class="italic font-light text-gray-300">A Precisão da Indústria.</span>
            </h1>
            
            <p class="text-lg text-gray-200 mb-10 font-light max-w-3xl mx-auto leading-relaxed">
                Móveis planejados de alto padrão com design assinado pela renomada <strong class="text-white">Arquiteta Maria Antonieta</strong>. 
                Utilizamos materiais nobres como <strong class="text-nec-gold">MDF Louro Freijó</strong> e <strong class="text-nec-gold">Laca Branca Fosca</strong>.
            </p>

            <div class="inline-block bg-white/10 backdrop-blur-md px-8 py-3 rounded-sm border border-white/20 mb-10">
                <span class="text-nec-gold font-bold text-xl block">45 Dias</span>
                <span class="text-xs uppercase tracking-widest text-gray-300">O Prazo mais rápido da cidade</span>
            </div>
            
            <div class="flex flex-col sm:flex-row gap-5 justify-center">
                <a href="#area-cliente" class="bg-nec-gold text-white hover:bg-white hover:text-nec-gold px-10 py-4 transition-all uppercase text-sm tracking-widest font-bold shadow-lg shadow-yellow-900/20 flex items-center justify-center gap-3">
                    <i class="fa-solid fa-magnifying-glass"></i> Acompanhar Meu Pedido
                </a>
                <a href="#contato" class="group border border-white hover:bg-white hover:text-nec-dark px-10 py-4 transition-all uppercase text-sm tracking-widest font-semibold backdrop-blur-sm">
                    Falar com Consultor
                </a>
            </div>
        </div>
    </section>
    </section>

    <section id="area-cliente" class="py-24 bg-nec-charcoal text-white relative overflow-hidden">
        <div class="absolute top-0 right-0 w-96 h-96 bg-nec-gold/5 rounded-full blur-3xl"></div>
        <div class="max-w-6xl mx-auto px-6 lg:px-12 grid lg:grid-cols-2 gap-16 items-center relative z-10">
            <div data-aos="fade-right">
                <span class="text-nec-gold font-bold tracking-widest uppercase text-sm mb-2 block">Transparência Total</span>
                <h2 class="font-serif text-4xl mb-6">Acompanhe sua produção.</h2>
                <p class="text-gray-400 mb-8 leading-relaxed">Digite seu CPF para ver o status real da sua produção. Se houver uma imagem do projeto (Render 3D) disponível, você poderá visualizá-la aqui.</p>
                <div class="bg-white/5 p-8 rounded-lg border border-white/10 backdrop-blur-sm">
                    <label class="block text-xs font-bold text-gray-400 mb-2 uppercase">CPF do Titular</label>
                    <div class="flex gap-4">
                        <input type="text" id="input-cpf" placeholder="Apenas números" class="w-full bg-black/50 border border-gray-600 text-white px-4 py-3 focus:outline-none focus:border-nec-gold">
                        <button onclick="buscarPedidoReal()" class="bg-nec-gold text-white px-6 py-3 font-bold uppercase text-sm hover:bg-white hover:text-nec-gold transition-colors" id="btn-buscar">Buscar</button>
                    </div>
                </div>
            </div>

            <div id="resultado-rastreio" class="hidden bg-white text-nec-dark p-8 rounded-lg shadow-2xl relative" data-aos="fade-left">
                <div class="flex justify-between items-center mb-6 border-b border-gray-200 pb-4">
                    <div>
                        <h3 class="font-bold text-lg uppercase" id="cliente-nome">---</h3>
                        <p class="text-sm text-gray-500" id="projeto-titulo">---</p>
                    </div>
                    <div class="text-right">
                         <a id="btn-render" href="#" target="_blank" class="hidden text-xs bg-nec-dark text-nec-gold px-3 py-1 rounded uppercase font-bold mb-2 inline-block hover:bg-black"><i class="fa-solid fa-image mr-1"></i> Ver 3D</a>
                         <div id="status-badge-container"></div>
                    </div>
                </div>
                <div class="pl-2" id="timeline-container"></div>
            </div>
            
            <div id="imagem-rastreio" class="relative h-full min-h-[300px] flex items-center justify-center border border-white/10 rounded-lg border-dashed">
                <div class="text-center text-gray-500">
                    <i class="fa-solid fa-box-open text-5xl mb-4 text-nec-gold opacity-50"></i>
                    <p class="text-sm uppercase tracking-widest">Aguardando Consulta</p>
                </div>
            </div>
        </div>
    </section>

    <section id="sobre" class="py-24 bg-white">
        <div class="max-w-7xl mx-auto px-6 lg:px-12 grid lg:grid-cols-2 gap-16 items-center">
            <div class="relative group" data-aos="fade-right">
                <div class="absolute -top-6 -left-6 w-full h-full border-2 border-nec-gold z-0 hidden lg:block"></div>
                <img src="https://images.unsplash.com/photo-1573496359142-b8d87734a5a2?q=80&w=800&auto=format&fit=crop" class="relative z-10 w-full h-[600px] object-cover shadow-2xl grayscale group-hover:grayscale-0 transition-all duration-700">
                <div class="absolute bottom-8 right-8 bg-white p-4 shadow-lg z-20"><p class="font-serif text-2xl text-nec-gold font-bold">Maria Antonieta</p><p class="text-xs uppercase tracking-widest text-gray-500">Arquiteta Responsável</p></div>
            </div>
            <div data-aos="fade-left">
                <span class="text-nec-gold font-bold tracking-widest uppercase text-sm">Design & Matéria-Prima</span>
                <h2 class="font-serif text-4xl lg:text-5xl text-nec-dark mt-4 mb-8">O Luxo está nos Detalhes.</h2>
                <p class="text-gray-600 text-lg leading-relaxed mb-6">Diferente de marcenarias comuns, aqui a técnica precede a produção. Sob a curadoria de <strong>Maria Antonieta</strong>, cada projeto é pensado para durar gerações.</p>
                <div class="bg-gray-50 p-6 border-l-4 border-nec-gold mb-8"><h4 class="font-bold text-nec-dark mb-2">Materiais Premium Utilizados:</h4><ul class="space-y-2 text-gray-600"><li><i class="fa-solid fa-check text-nec-gold mr-2"></i> MDF <strong>Louro Freijó</strong> (Toque natural e sofisticação)</li><li><i class="fa-solid fa-check text-nec-gold mr-2"></i> <strong>Laca Branca Fosca</strong> (Acabamento acetinado impecável)</li><li><i class="fa-solid fa-check text-nec-gold mr-2"></i> Ferragens com amortecimento (Tecnologia silenciosa)</li></ul></div>
                <a href="#contato" class="inline-block border-b-2 border-nec-dark pb-1 text-nec-dark font-bold hover:text-nec-gold hover:border-nec-gold transition-colors">Solicitar visita da Arquiteta</a>
            </div>
        </div>
    </section>

    <section id="contato" class="py-24 bg-nec-gray">
        <div class="max-w-4xl mx-auto px-6 text-center">
            <h2 class="font-serif text-4xl text-nec-dark mb-4">Inicie seu Projeto</h2>
            <p class="text-gray-600 mb-10">Preencha abaixo e nossa equipe entrará em contato.</p>
            <form class="bg-white p-10 shadow-xl rounded-sm text-left grid md:grid-cols-2 gap-6">
                <div><label class="text-xs font-bold text-gray-400">NOME</label><input type="text" class="w-full border-b border-gray-300 py-2 focus:border-nec-gold outline-none"></div>
                <div><label class="text-xs font-bold text-gray-400">TELEFONE/WHATSAPP</label><input type="tel" class="w-full border-b border-gray-300 py-2 focus:border-nec-gold outline-none"></div>
                <div class="md:col-span-2"><button class="w-full bg-nec-gold text-white py-4 font-bold uppercase tracking-widest hover:bg-black transition-colors">Enviar Solicitação</button></div>
            </form>
        </div>
    </section>

    <footer class="bg-black text-white pt-16 pb-8 border-t border-white/10">
        <div class="max-w-7xl mx-auto px-6 text-center">
            <p class="text-sm text-gray-500 mb-4">&copy; 2026 Marcenaria Modelo Moveis Planejados. Bairro Pelliciaria 2222, Andradina - SP.</p>
            
            <a href="admin.html" class="inline-flex items-center gap-2 text-xs text-gray-700 hover:text-nec-gold transition-colors uppercase tracking-widest font-bold py-2 px-4 rounded-full border border-transparent hover:border-nec-gold/20">
                <i class="fa-solid fa-lock"></i> Área Restrita
            </a>
        </div>
    </footer>
    <a href="https://wa.me/5518999999999" class="whatsapp-float" target="_blank"><i class="fa-brands fa-whatsapp"></i></a>

    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
    <script>
        AOS.init();
        function toggleMenu() { document.getElementById('mobile-menu').classList.toggle('hidden'); }

        // --- BUSCA REAL NO SUPABASE ---
        async function buscarPedidoReal() {
            const cpf = document.getElementById('input-cpf').value.trim();
            const btn = document.getElementById('btn-buscar');
            const resultDiv = document.getElementById('resultado-rastreio');
            const imgDiv = document.getElementById('imagem-rastreio');

            if (!cpf) return Swal.fire('Atenção', 'Digite o CPF para buscar.', 'warning');

            btn.innerHTML = '<i class="fa-solid fa-circle-notch fa-spin"></i>';
            btn.disabled = true;

            try {
                // 1. Busca Cliente
                const { data: cliente, error: errCli } = await supabaseClient
                    .from('clients')
                    .select('*, projects(*, project_steps(*))')
                    .eq('cpf', cpf)
                    .single();

                if (errCli || !cliente) throw new Error('Cliente não encontrado');

                // Pega o projeto mais recente
                const projeto = cliente.projects.sort((a,b) => new Date(b.created_at) - new Date(a.created_at))[0];

                if (!projeto) throw new Error('Nenhum projeto ativo para este cliente.');

                // PREENCHER DADOS NA TELA
                document.getElementById('cliente-nome').innerText = cliente.full_name;
                document.getElementById('projeto-titulo').innerText = projeto.title;

                // Botão Render (Se tiver imagem)
                const btnRender = document.getElementById('btn-render');
                if(projeto.render_url) {
                    btnRender.href = projeto.render_url;
                    btnRender.classList.remove('hidden');
                } else {
                    btnRender.classList.add('hidden');
                }

                // Renderizar Timeline
                const steps = projeto.project_steps.sort((a,b) => a.display_order - b.display_order);
                let timelineHTML = '';
                
                steps.forEach(step => {
                    const activeClass = step.is_completed ? 'completed' : '';
                    const dotClass = step.is_completed ? 'bg-nec-gold shadow-lg shadow-nec-gold/50' : 'bg-gray-300';
                    const textClass = step.is_completed ? 'text-nec-gold font-bold' : 'text-gray-400';
                    
                    // Verifica se é o status atual (o último completado)
                    const isCurrent = step.is_completed && (!steps[step.display_order] || !steps[step.display_order].is_completed);
                    const pulse = isCurrent ? 'animate-pulse' : '';

                    timelineHTML += `
                    <div class="timeline-item ${activeClass}">
                        <div class="timeline-dot ${dotClass} ${pulse}"></div>
                        <h4 class="text-sm uppercase ${textClass}">${step.step_name}</h4>
                        <p class="text-xs text-gray-400">${step.is_completed ? 'Concluído' : 'Pendente'}</p>
                    </div>`;
                });

                document.getElementById('timeline-container').innerHTML = timelineHTML;

                // Trocar telas
                imgDiv.classList.add('hidden');
                resultDiv.classList.remove('hidden');

            } catch (error) {
                console.error(error);
                Swal.fire('Não Encontrado', 'Verifique o CPF digitado ou entre em contato com a NEC.', 'error');
                imgDiv.classList.remove('hidden');
                resultDiv.classList.add('hidden');
            } finally {
                btn.innerHTML = 'BUSCAR';
                btn.disabled = false;
            }
        }

        // --- CARROSSEL ---
        const videos = document.querySelectorAll('.video-slide');
        let currentVideo = 0;
        setInterval(() => {
            videos[currentVideo].classList.remove('active');
            currentVideo = (currentVideo + 1) % videos.length;
            videos[currentVideo].classList.add('active');
            const bar = document.getElementById('progress-bar');
            bar.style.transition = 'none'; bar.style.width = '0';
            setTimeout(() => { bar.style.transition = 'width 6s linear'; bar.style.width = '100%'; }, 50);
        }, 6000);
        setTimeout(() => { document.getElementById('progress-bar').style.transition = 'width 6s linear'; document.getElementById('progress-bar').style.width = '100%'; }, 100);
    </script>
</body>
</html>